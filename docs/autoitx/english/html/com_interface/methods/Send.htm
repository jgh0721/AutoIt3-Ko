<!DOCTYPE html>
<html>
<head>
  <title>Method Send</title>
  <meta charset="ISO-8859-1">
  <link href="../../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1 class="small">Method Reference</h1>
<hr style="height:0px">
<h1>Send</h1>
<p class="funcdesc">Sends simulated keystrokes to the active window.<br></p>

<p class="codeheader">
Send "keys" [, flag]<br>
</p>

<h2>Parameters</h2>
<table>
  <tr>
    <td style="width:15%">keys</td>
    <td style="width:85%">The sequence of keys to send.</td>
  </tr>
  <tr>
   <td>flag</td>
   <td><b>Optional:</b> Changes how "keys" is processed:<br>
       flag = 0 (default), Text contains special characters like + and ! to indicate SHIFT and ALT key presses.<br>
       flag = 1, keys are sent raw.</td>
  </tr>
</table>


<h2>Return Value</h2>
None.<br>

<h2>Remarks</h2>
See the Appendix for some tips.<br>
<br>
The "Send" command syntax is similar to that of ScriptIt and the Visual Basic "SendKeys" command. Characters are sent as written with the exception of the following characters:<br>
<br>
'!'<br>
This tells AutoIt to send an ALT keystroke, therefore Send("This is text!a") would send the keys "This is text" and then press "ALT+a".<br>
<br>
N.B. Some programs are very choosy about capital letters and ALT keys, i.e. "!A" is different to "!a". The first says ALT+SHIFT+A, the second is ALT+a. If in doubt, use lowercase!<br>
<br>
'+'<br>
This tells AutoIt to send a SHIFT keystroke, therefore Send("Hell+o") would send the text "HellO". Send("!+a") would send "ALT+SHIFT+a".<br>
<br>
'^'<br>
This tells AutoIt to send a CONTROL keystroke, therefore Send("^!a") would send "CTRL+ALT+a".<br>
<br>
N.B. Some programs are very choosy about capital letters and CTRL keys, i.e. "^A" is different to "^a". The first says CTRL+SHIFT+A, the second is CTRL+a.  If in doubt, use lowercase!<br>
<br>
'#'<br>
The hash now sends a Windows keystroke; therefore, Send("#r") would send Win+r which launches the Run dialog box.<br>
<br>
You can set SendCapslockMode to make CAPS LOCK disabled at the start of a Send operation and restored upon completion.<br>
However, if a user is holding down the Shift key when a Send function begins, text may be sent in uppercase.<br>
One workaround is to Send("{SHIFTDOWN}{SHIFTUP}")  before the other Send operations.<br>
<br>
Certain special keys can be sent and should be enclosed in braces:<br>
<br>
N.B.  Windows does not allow the simulation of the "CTRL-ALT-DEL" combination!<br>
<table>
  <tr>
    <td><b>Send Command (if zero flag)</b></td>
    <td><b>Resulting Keypress</b></td>
  </tr>
  <tr>
    <td>{!}</td>
    <td>!</td>
  </tr>
  <tr>
    <td>{#}</td>
    <td>#</td>
  </tr>
  <tr>
    <td>{+}</td>
    <td>+</td>
  </tr>
  <tr>
    <td>{^}</td>
    <td>^</td>
  </tr>
  <tr>
    <td>{{}</td>
    <td>{</td>
  </tr>
  <tr>
    <td>{}}</td>
    <td>}</td>
  </tr>
  <tr>
    <td>{SPACE}</td>
    <td>SPACE</td>
  </tr>
  <tr>
    <td>{ENTER}</td>
    <td>ENTER key on the main keyboard</td>
  </tr>
  <tr>
    <td>{ALT}</td>
    <td>ALT</td>
  </tr>
  <tr>
    <td>{BACKSPACE} or {BS}</td>
    <td>BACKSPACE</td>
  </tr>
  <tr>
    <td>{DELETE} or {DEL}</td>
    <td>DELETE</td>
  </tr>
  <tr>
    <td>{UP}</td>
    <td>Cursor up</td>
  </tr>
  <tr>
    <td>{DOWN}</td>
    <td>Cursor down</td>
  </tr>
  <tr>
    <td>{LEFT}</td>
    <td>Cursor left</td>
  </tr>
  <tr>
    <td>{RIGHT}</td>
    <td>Cursor right</td>
  </tr>
  <tr>
    <td>{HOME}</td>
    <td>HOME</td>
  </tr>
  <tr>
    <td>{END}</td>
    <td>END</td>
  </tr>
  <tr>
    <td>{ESCAPE} or {ESC}</td>
    <td>ESCAPE</td>
  </tr>
  <tr>
    <td>{INSERT} or {INS}</td>
    <td>INS</td>
  </tr>
  <tr>
    <td>{PGUP}</td>
    <td>PageUp</td>
  </tr>
  <tr>
    <td>{PGDN}</td>
    <td>PageDown</td>
  </tr>
  <tr>
    <td>{F1} - {F12}</td>
    <td>Function keys</td>
  </tr>
  <tr>
    <td>{TAB}</td>
    <td>TAB</td>
  </tr>
  <tr>
    <td>{PRINTSCREEN}</td>
    <td>Print Screen key</td>
  </tr>
  <tr>
    <td>{LWIN}</td>
    <td>Left Windows key</td>
  </tr>
  <tr>
    <td>{RWIN}</td>
    <td>Right Windows key</td>
  </tr>
  <tr>
    <td>{NUMLOCK on}</td>
    <td>NUMLOCK (on/off/toggle)</td>
  </tr>
  <tr>
    <td>{CAPSLOCK off}</td>
    <td>CAPSLOCK (on/off/toggle)</td>
  </tr>
  <tr>
    <td>{SCROLLLOCK toggle}</td>
    <td>SCROLLLOCK (on/off/toggle)</td>
  </tr>
  <tr>
    <td>{BREAK}</td>
    <td>for Ctrl+Break processing</td>
  </tr>
  <tr>
    <td>{PAUSE}</td>
    <td>PAUSE</td>
  </tr>
  <tr>
    <td>{NUMPAD0} - {NUMPAD9}</td>
    <td>Numpad digits</td>
  </tr>
  <tr>
    <td>{NUMPADMULT}</td>
    <td>Numpad Multiply</td>
  </tr>
  <tr>
    <td>{NUMPADADD}</td>
    <td>Numpad Add</td>
  </tr>
  <tr>
    <td>{NUMPADSUB}</td>
    <td>Numpad Subtract</td>
  </tr>
  <tr>
    <td>{NUMPADDIV}</td>
    <td>Numpad Divide</td>
  </tr>
  <tr>
    <td>{NUMPADDOT}</td>
    <td>Numpad period</td>
  </tr>
  <tr>
    <td>{NUMPADENTER}</td>
    <td>Enter key on the numpad</td>
  </tr>
  <tr>
    <td>{APPSKEY}</td>
    <td>Windows App key</td>
  </tr>
  <tr>
    <td>{LALT}</td>
    <td>Left ALT key</td>
  </tr>
  <tr>
    <td>{RALT}</td>
    <td>Right ALT key</td>
  </tr>
  <tr>
    <td>{LCTRL}</td>
    <td>Left CTRL key</td>
  </tr>
  <tr>
    <td>{RCTRL}</td>
    <td>Right CTRL key</td>
  </tr>
  <tr>
    <td>{LSHIFT}</td>
    <td>Left Shift key</td>
  </tr>
  <tr>
    <td>{RSHIFT}</td>
    <td>Right Shift key</td>
  </tr>
  <tr>
    <td>{SLEEP}</td>
    <td>Computer SLEEP key</td>
  </tr>
  <tr>
    <td>{ALTDOWN}</td>
    <td>Holds the ALT key down until {ALTUP} is sent</td>
  </tr>
  <tr>
    <td>{SHIFTDOWN}</td>
    <td>Holds the SHIFT key down until {SHIFTUP} is sent</td>
  </tr>
  <tr>
    <td>{CTRLDOWN}</td>
    <td>Holds the CTRL key down until {CTRLUP} is sent</td>
  </tr>
  <tr>
    <td>{LWINDOWN}</td>
    <td>Holds the left Windows key down until {LWINUP} is sent</td>
  </tr>
  <tr>
    <td>{RWINDOWN}</td>
    <td>Holds the right Windows key down until {RWINUP} is sent</td>
  </tr>
  <tr>
    <td>{ASC nnnn}</td>
    <td>Send the ALT+nnnn key combination</td>
  </tr>
  <tr>
    <td>{BROWSER_BACK}</td>
    <td>XP Only: Select the browser "back" button</td>
  </tr>
  <tr>
    <td>{BROWSER_FORWARD}</td>
    <td>XP Only: Select the browser "forward" button</td>
  </tr>
  <tr>
    <td>{BROWSER_REFRESH}</td>
    <td>XP Only: Select the browser "refresh" button</td>
  </tr>
  <tr>
    <td>{BROWSER_STOP}</td>
    <td>XP Only: Select the browser "stop" button</td>
  </tr>
  <tr>
    <td>{BROWSER_SEARCH}</td>
    <td>XP Only: Select the browser "search" button</td>
  </tr>
  <tr>
    <td>{BROWSER_FAVORITES}</td>
    <td>XP Only: Select the browser "favorites" button</td>
  </tr>
  <tr>
    <td>{BROWSER_HOME}</td>
    <td>XP Only: Launch the browser and go to the home page</td>
  </tr>
  <tr>
    <td>{VOLUME_MUTE}</td>
    <td>XP Only: Mute the volume</td>
  </tr>
  <tr>
    <td>{VOLUME_DOWN}</td>
    <td>XP Only: Reduce the volume</td>
  </tr>
  <tr>
    <td>{VOLUME_UP}</td>
    <td>XP Only: Increase the volume</td>
  </tr>
  <tr>
    <td>{MEDIA_NEXT}</td>
    <td>XP Only: Select next track in media player</td>
  </tr>
  <tr>
    <td>{MEDIA_PREV}</td>
    <td>XP Only: Select previous track in media player</td>
  </tr>
  <tr>
    <td>{MEDIA_STOP}</td>
    <td>XP Only: Stop media player</td>
  </tr>
  <tr>
    <td>{MEDIA_PLAY_PAUSE}</td>
    <td>XP Only: Play/pause media player</td>
  </tr>
  <tr>
    <td>{LAUNCH_MAIL}</td>
    <td>XP Only: Launch the email application</td>
  </tr>
  <tr>
    <td>{LAUNCH_MEDIA}</td>
    <td>XP Only: Launch media player</td>
  </tr>
  <tr>
    <td>{LAUNCH_APP1}</td>
    <td>XP Only: Launch user app1</td>
  </tr>
  <tr>
    <td>{LAUNCH_APP2}</td>
    <td>XP Only: Launch user app2</td>
  </tr>
</table><br>
To send the ASCII value A (same as pressing ALT+065 on the numeric keypad)<br>
&nbsp;&nbsp;&nbsp; Send("{ASC 65}")<br>
<br>
Single keys can also be repeated, e.g.<br>
&nbsp;&nbsp;&nbsp; Send("{DEL 4}")    ;Presses the DEL key 4 times<br>
&nbsp;&nbsp;&nbsp; Send("{S 30}")      ;Sends 30 'S' characters<br>
&nbsp;&nbsp;&nbsp; Send("+{TAB 4})   ;Presses SHIFT+TAB 4 times<br>
<br>
To hold a key down (generally only useful for games)<br>
&nbsp;&nbsp;&nbsp; Send("{a down}")    ;Holds the A key down<br>
&nbsp;&nbsp;&nbsp; Send("{a up}")        ;Releases the A key<br>
<br>
To set the state of the capslock, numlock and scrolllock keys<br>
&nbsp;&nbsp;&nbsp; Send("{NumLock on}")        ;Turns the NumLock key on<br>
&nbsp;&nbsp;&nbsp; Send("{CapsLock off}")      ;Turns the CapsLock key off<br>
&nbsp;&nbsp;&nbsp; Send("{ScrollLock toggle}") ;Toggles the state of ScrollLock<br>
<br>
If you with to use a variable for the count, try<br>
&nbsp;&nbsp;&nbsp; $n = 4<br>
&nbsp;&nbsp;&nbsp; Send("+{TAB " & $n & "}")<br>
<br>
If you wish to send the ASCII value A four times, then try<br>
&nbsp;&nbsp;&nbsp; $x = Chr(65)<br>
&nbsp;&nbsp;&nbsp; Send("{" & $x & " 4}")<br>
<br>
Most laptop computer keyboards have a special Fn key.  This key cannot be simulated.<br>
<br>
Note, by setting the flag parameter to 1 the above "special" processing will be disabled.  This is useful when you want to send some text copied from a variable and you want the text sent exactly as written.<br>
<br>
For example, open Folder Options (in the control panel) and try the following:<br>
<table>
  <tr>
    <td>Send("{TAB}")</td>
    <td>Navigate to next control (button, checkbox, etc)</td>
  </tr>
  <tr>
    <td>Send("+{TAB}")</td>
    <td>Navigate to previous control.</td>
  </tr>
  <tr>
    <td>Send("^{TAB}")</td>
    <td>Navigate to next WindowTab (on a Tabbed dialog window)</td>
  </tr>
  <tr>
    <td>Send("^+{TAB}")</td>
    <td>Navigate to previous WindowTab.</td>
  </tr>
  <tr>
    <td>Send("{SPACE}")</td>
    <td>Can be used to toggle a checkbox or click a button.</td>
  </tr>
  <tr>
    <td>Send("{+}")</td>
    <td>Usually checks a checkbox (if it's a "real" checkbox.)</td>
  </tr>
  <tr>
    <td>Send("{-}")</td>
    <td>Usually unchecks a checkbox.</td>
  </tr>
  <tr>
    <td>Send("{NumPadMult}")</td>
    <td>Recursively expands folders in a SysTreeView32.</td>
  </tr>
</table><br>
Use Alt-key combos to access menu items.  Also, open Notepad and try the following:<br>
Send("!f") Send Alt+f, the access key for Notepad's file menu. Try other letters!<br>
<br>
<table>
  <tr>
    <td>Send("{DOWN}")</td>
    <td>Move down a menu.</td>
  </tr>
  <tr>
    <td>Send("{UP}")</td>
    <td>Move up a menu.</td>
  </tr>
  <tr>
    <td>Send("{LEFT}")</td>
    <td>Move leftward to new menu or expand a submenu.</td>
  </tr>
  <tr>
    <td>Send("{RIGHT}")</td>
    <td>Move rightward to new menu or collapse a submenu.</td>
  </tr>
</table>See Windows' Help--press Win+F1--for a complete list of keyboard shortcuts if you don't know the importance of Alt+F4, PrintScreen, Ctrl+C, and so on.<br>
<br>

<h2>Related</h2>
<a href="AutoItSetOption.htm#SendAttachmode">SendAttachmode (Option)</a>, <a href="AutoItSetOption.htm#SendKeyDelay">SendKeyDelay (Option)</a>, <a href="AutoItSetOption.htm#SendKeyDownDelay">SendKeyDownDelay (Option)</a>, <a href="ControlSend.htm">ControlSend</a>


<h2 class="bottom">Example</h2>
<script type="text/javascript">
if ((navigator.appName=="Microsoft Internet Explorer") && (parseInt(navigator.appVersion)>=4)) // IE (4+) only
    function copyToClipboard(s){if (window.clipboardData && clipboardData.setData){clipboardData.setData("text", s + "\r\n");alert("Copied to clipboard");}}
</script>
<div class="codeSnippetContainer">
    <div class="codeSnippetContainerTabs">
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
<script type="text/javascript">
if ((navigator.appName=="Microsoft Internet Explorer") && (parseInt(navigator.appVersion)>=4)) // IE (4+) only
    document.write('<a href="#" id="copy" onclick="copyToClipboard(document.getElementById(\'copytext0\').innerText)">Copy to clipboard</a>');
</script>
            </div>
        </div>
        <div id="copytext0" class="codeSnippetContainerCode" dir="ltr">
<div style="color:Black;"><pre>
Set oAutoIt = WScript.CreateObject("AutoItX3.Control")
oAutoIt.Send "#r"
oAutoIt.WinWaitActive "Run"
oAutoIt.Send "notepad.exe{Enter}"
oAutoIt.WinWaitActive "Untitled -"
oAutoIt.Send "Today's time/date is {F5}"
</pre></div>
		</div>
	</div>
</div>


</body>
</html>
