<!DOCTYPE html>
<html>
<head>
  <title>Function StringToASCIIArray</title>
  <meta charset="ISO-8859-1">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1 class="small">Function Reference</h1>
<hr style="height:0px">
<h1>StringToASCIIArray</h1>
<p class="funcdesc">Converts a string to an array containing the ASCII code of each character.<br></p>

<p class="codeheader">
StringToASCIIArray ( "string", [start = 0 [, end [, encoding = 0]]] )<br>
</p>

<h2>Parameters</h2>
<table>
  <tr>
    <td style="width:15%">"string"</td>
    <td style="width:85%">The string to convert to an array of ASCII codes.</td>
  </tr>
  <tr>
   <td>start</td>
   <td>	<b>[optional]</b> The 0-based position to start processing from (Default: 0).</td>
  </tr>
  <tr>
   <td>end</td>
   <td>	<b>[optional]</b> The 0-based position to end processing at (Default: StringLen("string")).</td>
  </tr>
  <tr>
   <td>encoding</td>
   <td>	<b>[optional]</b> The returned array will contain values in the specified character set:<br>
       0 - UTF-16 (Default)<br>
       1 - ANSI<br>
       2 - UTF-8</td>
  </tr>
</table>


<h2>Return Value</h2>
<table class="noborder">
  <tr>
    <td style="width:10%" valign="top">Success:</td>
    <td style="width:90%">An array where each element is the UNICODE code of the character at the corresponding position.</td>
  </tr>
  <tr>
    <td valign="top">Failure:</td>
    <td>Returns an empty string.</td>
  </tr>
</table>

<h2>Remarks</h2>
The string may contain embedded Chr(0).  These will appear in the returned array as well as any data past them.  Processing only stops when the end of the string is reached or the user specified end.<br>
<br>
In order to convert binary data to an array using this function it must first be converted to a string with the BinaryToString() function.<br>
<br>

<h2>Related</h2>
<a href="StringFromASCIIArray.htm">StringFromASCIIArray</a>, <a href="BinaryToString.htm">BinaryToString</a>


<h2 class="bottom">Example</h2>
<script type="text/javascript">
if ((navigator.appName=="Microsoft Internet Explorer") && (parseInt(navigator.appVersion)>=4)) // IE (4+) only
    function copyToClipboard(s){if (window.clipboardData && clipboardData.setData){clipboardData.setData("text", s + "\r\n");alert("Copied to clipboard");}}
</script>
<div class="codeSnippetContainer">
    <div class="codeSnippetContainerTabs">
<script type="text/javascript">
if (document.URL.match(/^mk:@MSITStore:/i))
{
document.write('<div class="codeSnippetContainerTab codeSnippetContainerTabSingle" dir="ltr">');
document.write('<object id=hhctrl type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"><param name="Command" value="ShortCut"><param name="Font" value="Verdana,10pt"><param name="Text" value="Text:Open this Script"><param name="Item1" value=",Examples\\HelpFile\\StringToASCIIArray.au3,"></object>');
document.write('</div>');
}
</script>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
<script type="text/javascript">
if ((navigator.appName=="Microsoft Internet Explorer") && (parseInt(navigator.appVersion)>=4)) // IE (4+) only
    document.write('<a href="#" id="copy" onclick="copyToClipboard(document.getElementById(\'copytext0\').innerText)">Copy to clipboard</a>');
</script>
            </div>
        </div>
        <div id="copytext0" class="codeSnippetContainerCode" dir="ltr">
<div style="color:Black;"><pre>
<span><span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;Array.au3&gt;</span><span class="S0"> </span><span class="S1">; Required for _ArrayDisplay() only.</span>
<span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;Constants.au3&gt;</span>

<span class="S0">Example</span><span class="S8">()</span>

<span class="S5">Func</span><span class="S0"> Example</span><span class="S8">()</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Convert the string to an ASCII array.</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$aArray</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">StringToASCIIArray</span><span class="S8">(</span><span class="S7">"This is a sentence with whitespace."</span><span class="S8">)</span>

<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Display the array to see that it contains the ASCII values for each character in the string.</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S15">_ArrayDisplay</span><span class="S8">(</span><span class="S9">$aArray</span><span class="S8">)</span>

<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Convert the array into a string.</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$sString</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">StringFromASCIIArray</span><span class="S8">(</span><span class="S9">$aArray</span><span class="S8">)</span>

<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Display the string to see that it matches the original string initially converted to an array.</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">MsgBox</span><span class="S8">(</span><span class="S9">$MB_SYSTEMMODAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sString</span><span class="S8">)</span>
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;Example</span>
<span class="S0"></span></span>
</pre></div>
		</div>
	</div>
</div>


</body>
</html>
