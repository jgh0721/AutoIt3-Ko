<!DOCTYPE html>
<html>
<head>
  <title>Function Send</title>
  <meta charset="ISO-8859-1">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1 class="small">Function Reference</h1>
<hr style="height:0px">
<h1>Send</h1>
<p class="funcdesc">Sends simulated keystrokes to the active window.<br></p>

<p class="codeheader">
Send ( "keys" [, flag = 0] )<br>
</p>

<h2>Parameters</h2>
<table>
  <tr>
    <td style="width:15%">keys</td>
    <td style="width:85%">The sequence of keys to send.</td>
  </tr>
  <tr>
   <td>flag</td>
   <td>	<b>[optional]</b> Changes how "keys" is processed:<br>
       flag = 0 (default), Text contains special characters like + and ! to indicate SHIFT and ALT key-presses.<br>
       flag = 1, keys are sent raw.</td>
  </tr>
</table>


<h2>Return Value</h2>
None.<br>

<h2>Remarks</h2>
See the <a href="../appendix/SendKeys.htm">Appendix</a> for some tips on using Send. AutoIt can send all ASCII and Extended ASCII characters (0-255). To send UNICODE characters you must use the "ASC" option and the code of the character you wish to send (see {ASC} at the bottom of the table below).<br>
<br>
The "Send" command syntax is similar to that of ScriptIt and the Visual Basic "SendKeys" command. Characters are sent as written with the exception of the following characters:<br>
<br>
'!'<br>
This tells AutoIt to send an ALT keystroke, therefore Send("This is text!a") would send the keys "This is text" and then press "ALT+a".<br>
<br>
N.B. Some programs are very choosy about capital letters and ALT keys, i.e., "!A" is different from "!a". The first says ALT+SHIFT+A, the second is ALT+a. If in doubt, use lowercase!<br>
<br>
'+'<br>
This tells AutoIt to send a SHIFT keystroke; therefore, Send("Hell+o") would send the text "HellO". Send("!+a") would send "ALT+SHIFT+a".<br>
<br>
'^'<br>
This tells AutoIt to send a CONTROL keystroke; therefore, Send("^!a") would send "CTRL+ALT+a".<br>
<br>
N.B. Some programs are very choosy about capital letters and CTRL keys, i.e., "^A" is different from "^a". The first says CTRL+SHIFT+A, the second is CTRL+a. If in doubt, use lowercase!<br>
<br>
'#'<br>
The hash now sends a Windows keystroke; therefore, Send("#r") would send Win+r which launches the Run dialog box.<br>
<br>
You can set SendCapslockMode to make CAPS LOCK disabled at the start of a Send operation and restored upon completion.<br>
However, if a user is holding down the Shift key when a Send function begins, text may be sent in uppercase.<br>
One workaround is to Send("{SHIFTDOWN}{SHIFTUP}")  before the other Send operations.<br>
<br>
Certain keyboards as the Czech keyboard sends different characters when using the Shift Key or with CAPS LOCK enabled while sending a character. Due to the send AutoIt implementation the CAPS LOCKed character will be sent as a Shifted character so <b>it will not work.</b><br>
Certain special keys can be sent and should be enclosed in braces:<br>
<br>
N.B. Windows does not allow the simulation of the "CTRL-ALT-DEL" combination!<br>
<br>
<br><table>
  <tr>
    <th><b>Send Command (if zero flag)</b></th>
    <th><b>Resulting Keypress</b></th>
  </tr>
  <tr>
    <td>{!}</td>
    <td>!</td>
  </tr>
  <tr>
    <td>{#}</td>
    <td>#</td>
  </tr>
  <tr>
    <td>{+}</td>
    <td>+</td>
  </tr>
  <tr>
    <td>{^}</td>
    <td>^</td>
  </tr>
  <tr>
    <td>{{}</td>
    <td>{</td>
  </tr>
  <tr>
    <td>{}}</td>
    <td>}</td>
  </tr>
  <tr>
    <td>{SPACE}</td>
    <td>SPACE</td>
  </tr>
  <tr>
    <td>{ENTER}</td>
    <td>ENTER key on the main keyboard</td>
  </tr>
  <tr>
    <td>{ALT}</td>
    <td>ALT</td>
  </tr>
  <tr>
    <td>{BACKSPACE} or {BS}</td>
    <td>BACKSPACE</td>
  </tr>
  <tr>
    <td>{DELETE} or {DEL}</td>
    <td>DELETE</td>
  </tr>
  <tr>
    <td>{UP}</td>
    <td>Up arrow</td>
  </tr>
  <tr>
    <td>{DOWN}</td>
    <td>Down arrow</td>
  </tr>
  <tr>
    <td>{LEFT}</td>
    <td>Left arrow</td>
  </tr>
  <tr>
    <td>{RIGHT}</td>
    <td>Right arrow</td>
  </tr>
  <tr>
    <td>{HOME}</td>
    <td>HOME</td>
  </tr>
  <tr>
    <td>{END}</td>
    <td>END</td>
  </tr>
  <tr>
    <td>{ESCAPE} or {ESC}</td>
    <td>ESCAPE</td>
  </tr>
  <tr>
    <td>{INSERT} or {INS}</td>
    <td>INS</td>
  </tr>
  <tr>
    <td>{PGUP}</td>
    <td>PageUp</td>
  </tr>
  <tr>
    <td>{PGDN}</td>
    <td>PageDown</td>
  </tr>
  <tr>
    <td>{F1} - {F12}</td>
    <td>Function keys</td>
  </tr>
  <tr>
    <td>{TAB}</td>
    <td>TAB</td>
  </tr>
  <tr>
    <td>{PRINTSCREEN}</td>
    <td>Print Screen key</td>
  </tr>
  <tr>
    <td>{LWIN}</td>
    <td>Left Windows key</td>
  </tr>
  <tr>
    <td>{RWIN}</td>
    <td>Right Windows key</td>
  </tr>
  <tr>
    <td>{NUMLOCK on}</td>
    <td>NUMLOCK (on/off/toggle)</td>
  </tr>
  <tr>
    <td>{CAPSLOCK off}</td>
    <td>CAPSLOCK (on/off/toggle)</td>
  </tr>
  <tr>
    <td>{SCROLLLOCK toggle}</td>
    <td>SCROLLLOCK (on/off/toggle)</td>
  </tr>
  <tr>
    <td>{BREAK}</td>
    <td>for Ctrl+Break processing</td>
  </tr>
  <tr>
    <td>{PAUSE}</td>
    <td>PAUSE</td>
  </tr>
  <tr>
    <td>{NUMPAD0} - {NUMPAD9}</td>
    <td>Numpad digits</td>
  </tr>
  <tr>
    <td>{NUMPADMULT}</td>
    <td>Numpad Multiply</td>
  </tr>
  <tr>
    <td>{NUMPADADD}</td>
    <td>Numpad Add</td>
  </tr>
  <tr>
    <td>{NUMPADSUB}</td>
    <td>Numpad Subtract</td>
  </tr>
  <tr>
    <td>{NUMPADDIV}</td>
    <td>Numpad Divide</td>
  </tr>
  <tr>
    <td>{NUMPADDOT}</td>
    <td>Numpad period</td>
  </tr>
  <tr>
    <td>{NUMPADENTER}</td>
    <td>Enter key on the numpad</td>
  </tr>
  <tr>
    <td>{APPSKEY}</td>
    <td>Windows App key</td>
  </tr>
  <tr>
    <td>{LALT}</td>
    <td>Left ALT key</td>
  </tr>
  <tr>
    <td>{RALT}</td>
    <td>Right ALT key</td>
  </tr>
  <tr>
    <td>{LCTRL}</td>
    <td>Left CTRL key</td>
  </tr>
  <tr>
    <td>{RCTRL}</td>
    <td>Right CTRL key</td>
  </tr>
  <tr>
    <td>{LSHIFT}</td>
    <td>Left Shift key</td>
  </tr>
  <tr>
    <td>{RSHIFT}</td>
    <td>Right Shift key</td>
  </tr>
  <tr>
    <td>{SLEEP}</td>
    <td>Computer SLEEP key</td>
  </tr>
  <tr>
    <td>{ALTDOWN}</td>
    <td>Holds the ALT key down until {ALTUP} is sent</td>
  </tr>
  <tr>
    <td>{SHIFTDOWN}</td>
    <td>Holds the SHIFT key down until {SHIFTUP} is sent</td>
  </tr>
  <tr>
    <td>{CTRLDOWN}</td>
    <td>Holds the CTRL key down until {CTRLUP} is sent</td>
  </tr>
  <tr>
    <td>{LWINDOWN}</td>
    <td>Holds the left Windows key down until {LWINUP} is sent</td>
  </tr>
  <tr>
    <td>{RWINDOWN}</td>
    <td>Holds the right Windows key down until {RWINUP} is sent</td>
  </tr>
  <tr>
    <td>{ASC nnnn}</td>
    <td>Send the ALT+nnnn key combination</td>
  </tr>
  <tr>
    <td>{BROWSER_BACK}</td>
    <td>Select the browser "back" button</td>
  </tr>
  <tr>
    <td>{BROWSER_FORWARD}</td>
    <td>Select the browser "forward" button</td>
  </tr>
  <tr>
    <td>{BROWSER_REFRESH}</td>
    <td>Select the browser "refresh" button</td>
  </tr>
  <tr>
    <td>{BROWSER_STOP}</td>
    <td>Select the browser "stop" button</td>
  </tr>
  <tr>
    <td>{BROWSER_SEARCH}</td>
    <td>Select the browser "search" button</td>
  </tr>
  <tr>
    <td>{BROWSER_FAVORITES}</td>
    <td>Select the browser "favorites" button</td>
  </tr>
  <tr>
    <td>{BROWSER_HOME}</td>
    <td>Launch the browser and go to the home page</td>
  </tr>
  <tr>
    <td>{VOLUME_MUTE}</td>
    <td>Mute the volume</td>
  </tr>
  <tr>
    <td>{VOLUME_DOWN}</td>
    <td>Reduce the volume</td>
  </tr>
  <tr>
    <td>{VOLUME_UP}</td>
    <td>Increase the volume</td>
  </tr>
  <tr>
    <td>{MEDIA_NEXT}</td>
    <td>Select next track in media player</td>
  </tr>
  <tr>
    <td>{MEDIA_PREV}</td>
    <td>Select previous track in media player</td>
  </tr>
  <tr>
    <td>{MEDIA_STOP}</td>
    <td>Stop media player</td>
  </tr>
  <tr>
    <td>{MEDIA_PLAY_PAUSE}</td>
    <td>Play/pause media player</td>
  </tr>
  <tr>
    <td>{LAUNCH_MAIL}</td>
    <td>Launch the email application</td>
  </tr>
  <tr>
    <td>{LAUNCH_MEDIA}</td>
    <td>Launch media player</td>
  </tr>
  <tr>
    <td>{LAUNCH_APP1}</td>
    <td>Launch user app1</td>
  </tr>
  <tr>
    <td>{LAUNCH_APP2}</td>
    <td>Launch user app2</td>
  </tr>
</table><br>
To send the ASCII value A (same as pressing ALT+065 on the numeric keypad)<br>
&nbsp;&nbsp;&nbsp; Send("{ASC 065}")<br>
<br>
(When using 2 digit ASCII codes you must use a leading 0, otherwise an obsolete 437 code page is used).<br>
<br>
To send UNICODE characters enter the character code (decimal or hex), for example this sends a Chinese character<br>
&nbsp;&nbsp;&nbsp; Send("{ASC 2709}") or Send("{ASC 0xA95}")<br>
<br>
Single keys can also be repeated, e.g.<br>
&nbsp;&nbsp;&nbsp; Send("{DEL 4}")    ;Presses the DEL key 4 times<br>
&nbsp;&nbsp;&nbsp; Send("{S 30}")      ;Sends 30 'S' characters<br>
&nbsp;&nbsp;&nbsp; Send("+{TAB 4}")   ;Presses SHIFT+TAB 4 times<br>
<br>
The key will be send at least once even if the count is zero.<br>
<br>
To hold a key down<br>
&nbsp;&nbsp;&nbsp; Send("{a down}")    ;Holds the A key down<br>
&nbsp;&nbsp;&nbsp; Send("{a up}")        ;Releases the A key<br>
<br>
To set the state of the capslock, numlock and scrolllock keys<br>
&nbsp;&nbsp;&nbsp; Send("{NumLock on}")        ;Turns the NumLock key on<br>
&nbsp;&nbsp;&nbsp; Send("{CapsLock off}")      ;Turns the CapsLock key off<br>
&nbsp;&nbsp;&nbsp; Send("{ScrollLock toggle}") ;Toggles the state of ScrollLock<br>
<br>
If you wish to use a variable for the count, try<br>
&nbsp;&nbsp;&nbsp; $n = 4<br>
&nbsp;&nbsp;&nbsp; Send("+{TAB " & $n & "}")<br>
<br>
If you wish to send the ASCII value A four times, then try<br>
&nbsp;&nbsp;&nbsp; $x = Chr(65)<br>
&nbsp;&nbsp;&nbsp; Send("{" & $x & " 4}")<br>
<br>
Most laptop computer keyboards have a special Fn key.  This key cannot be simulated.<br>
<br>
Note, by setting the flag parameter to 1 the above "special" processing will be disabled.  This is useful when you want to send some text copied from a variable and you want the text sent exactly as written.<br>
<br>
For example, open Folder Options (in the control panel) and try the following:<br>
<br>
<br><table>
  <tr>
    <th>Send("{TAB}")</th>
    <th>Navigate to next control (button, checkbox, etc)</th>
  </tr>
  <tr>
    <td>Send("+{TAB}")</td>
    <td>Navigate to previous control.</td>
  </tr>
  <tr>
    <td>Send("^{TAB}")</td>
    <td>Navigate to next WindowTab (on a Tabbed dialog window)</td>
  </tr>
  <tr>
    <td>Send("^+{TAB}")</td>
    <td>Navigate to previous WindowTab.</td>
  </tr>
  <tr>
    <td>Send("{SPACE}")</td>
    <td>Can be used to toggle a checkbox or click a button.</td>
  </tr>
  <tr>
    <td>Send("{+}")</td>
    <td>Usually checks a checkbox (if it's a "real" checkbox.)</td>
  </tr>
  <tr>
    <td>Send("{-}")</td>
    <td>Usually unchecks a checkbox.</td>
  </tr>
  <tr>
    <td>Send("{NumPadMult}")</td>
    <td>Recursively expands folders in a SysTreeView32.</td>
  </tr>
</table><br>
Use Alt-key combos to access menu items.  Also, open Notepad and try the following:<br>
Send("!f") Send Alt+f, the access key for Notepad's file menu. Try other letters!<br>
<br>
<br><table>
  <tr>
    <th>Send("{DOWN}")</th>
    <th>Move down a menu.</th>
  </tr>
  <tr>
    <td>Send("{UP}")</td>
    <td>Move up a menu.</td>
  </tr>
  <tr>
    <td>Send("{LEFT}")</td>
    <td>Move leftward to new menu or expand a submenu.</td>
  </tr>
  <tr>
    <td>Send("{RIGHT}")</td>
    <td>Move rightward to new menu or collapse a submenu.</td>
  </tr>
</table>See Windows' Help--press Win+F1--for a complete list of keyboard shortcuts if you don't know the importance of Alt+F4, PrintScreen, Ctrl+C, and so on.<br>
<br>
When running a script on a remote computer through a program as psexec (www.sysinternals.com) or beyondexec (www.beyondlogic.org) it is necessary, specially when sending strokes to a program launch by the script with a Run function, to use <b>ControlSend</b> or other ControlXXX functions to directly communicate with the control. Send even with Opt("SendAttachMode", 1) will not work.<br>
Using the -s mode when submitting can help to have better rights on the remote computer.<br>
<br>
Opt("SendKeyDelay",...) alters the the length of the brief pause in between sent keystrokes.<br>
Opt("SendKeyDownDelay",...) alters the length of time a key is held down before being released during a keystroke.<br>
Set both "SendKeyDelay" and "SendKeyDownDelay" to 0 to remove all delays when sending keystrokes.  This may be required under certain circumstances, for example, when locking the system ("#l") it may be necessary to remove the delays in order to prevent the WIN key from being stuck down.<br>
<br>

<h2>Related</h2>
<a href="AutoItSetOption.htm#SendAttachMode">SendAttachMode (Option)</a>, <a href="SendKeepActive.htm">SendKeepActive</a>, <a href="AutoItSetOption.htm#SendKeyDelay">SendKeyDelay (Option)</a>, <a href="AutoItSetOption.htm#SendKeyDownDelay">SendKeyDownDelay (Option)</a>, <a href="ControlSend.htm">ControlSend</a>, <a href="BlockInput.htm">BlockInput</a>, <a href="HotKeySet.htm">HotKeySet</a>, <a href="WinMenuSelectItem.htm">WinMenuSelectItem</a>


<h2 class="bottom">Example</h2>
<script type="text/javascript">
if ((navigator.appName=="Microsoft Internet Explorer") && (parseInt(navigator.appVersion)>=4)) // IE (4+) only
    function copyToClipboard(s){if (window.clipboardData && clipboardData.setData){clipboardData.setData("text", s + "\r\n");alert("Copied to clipboard");}}
</script>
<div class="codeSnippetContainer">
    <div class="codeSnippetContainerTabs">
<script type="text/javascript">
if (document.URL.match(/^mk:@MSITStore:/i))
{
document.write('<div class="codeSnippetContainerTab codeSnippetContainerTabSingle" dir="ltr">');
document.write('<object id=hhctrl type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"><param name="Command" value="ShortCut"><param name="Font" value="Verdana,10pt"><param name="Text" value="Text:Open this Script"><param name="Item1" value=",Examples\\HelpFile\\Send.au3,"></object>');
document.write('</div>');
}
</script>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
<script type="text/javascript">
if ((navigator.appName=="Microsoft Internet Explorer") && (parseInt(navigator.appVersion)>=4)) // IE (4+) only
    document.write('<a href="#" id="copy" onclick="copyToClipboard(document.getElementById(\'copytext0\').innerText)">Copy to clipboard</a>');
</script>
            </div>
        </div>
        <div id="copytext0" class="codeSnippetContainerCode" dir="ltr">
<div style="color:Black;"><pre>
<span><span class="S0">Example</span><span class="S8">()</span>

<span class="S5">Func</span><span class="S0"> Example</span><span class="S8">()</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Simulate the key combination Win + R to open the Run dialogue window.</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">Send</span><span class="S8">(</span><span class="S7">"#r"</span><span class="S8">)</span>

<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Wait 10 seconds for the Run dialogue window to appear.</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">WinWait</span><span class="S8">(</span><span class="S7">"Run"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">)</span>

<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Simulate entering notepad.exe and pressing the 'ENTER' key.</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">Send</span><span class="S8">(</span><span class="S7">"notepad.exe</span><span class="S10">{Enter}</span><span class="S7">"</span><span class="S8">)</span>

<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Wait 10 seconds for the Notepad window to appear.</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$hWnd</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">WinWait</span><span class="S8">(</span><span class="S7">"[CLASS:Notepad]"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">)</span>

<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Simulate entering the following string and pressing the 'F5' key to input the date and time into edit control of Notepad.</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">Send</span><span class="S8">(</span><span class="S7">"Today's time/date is </span><span class="S10">{F5}</span><span class="S7">"</span><span class="S8">)</span>

<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Close the Notepad window using the handle returned by WinWait.</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">WinClose</span><span class="S8">(</span><span class="S9">$hWnd</span><span class="S8">)</span>

<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Now a screen will pop up and ask to save the changes, the classname of the window is called</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; "#32770" and simulating the "TAB" key to move to the second button in which the "ENTER" is simulated to not "save the file"</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">WinWaitActive</span><span class="S8">(</span><span class="S7">"[CLASS:#32770]"</span><span class="S8">)</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">Sleep</span><span class="S8">(</span><span class="S3">500</span><span class="S8">)</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">Send</span><span class="S8">(</span><span class="S7">"</span><span class="S10">{TAB}{ENTER}</span><span class="S7">"</span><span class="S8">)</span>
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;Example</span>
<span class="S0"></span></span>
</pre></div>
		</div>
	</div>
</div>


</body>
</html>
