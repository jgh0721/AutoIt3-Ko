<!DOCTYPE html>
<html>
<head>
  <title>Function AdlibRegister</title>
  <meta charset="ISO-8859-1">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1 class="small">Function Reference</h1>
<hr style="height:0px">
<h1>AdlibRegister</h1>
<p class="funcdesc">Registers an Adlib function.<br></p>

<p class="codeheader">
AdlibRegister ( "function" [, time = 250] )<br>
</p>

<h2>Parameters</h2>
<table>
  <tr>
    <td style="width:15%">function</td>
    <td style="width:85%">The name of the adlib function to be registered.</td>
  </tr>
  <tr>
   <td>time</td>
   <td>	<b>[optional]</b> how often in milliseconds to call the function.   Default is 250 ms.</td>
  </tr>
</table>


<h2>Return Value</h2>
<table class="noborder">
  <tr>
    <td style="width:10%" valign="top">Success:</td>
    <td style="width:90%">Returns 1.</td>
  </tr>
  <tr>
    <td valign="top">Failure:</td>
    <td>Returns 0.</td>
  </tr>
</table>

<h2>Remarks</h2>
Every 250 ms (or <i>time</i> ms) the specified "function" is called--typically to check for unforeseen errors.  For example, you could use adlib in a  script which causes an error window to pop up unpredictably.<br>
The adlib function should be kept simple as it is executed often and during this time the main script is paused.  Also, the time parameter should be used carefully to avoid CPU load.<br>
You can not register a function using parameters.<br>
<br>
Several Adlib functions can be registered.  Re-registering an already existing Adlib function will update it with a new time.<br>
<br>

<h2>Related</h2>
<a href="AdlibUnRegister.htm">AdlibUnRegister</a>


<h2 class="bottom">Example</h2>
<script type="text/javascript">
if ((navigator.appName=="Microsoft Internet Explorer") && (parseInt(navigator.appVersion)>=4)) // IE (4+) only
    function copyToClipboard(s){if (window.clipboardData && clipboardData.setData){clipboardData.setData("text", s + "\r\n");alert("Copied to clipboard");}}
</script>
<div class="codeSnippetContainer">
    <div class="codeSnippetContainerTabs">
<script type="text/javascript">
if (document.URL.match(/^mk:@MSITStore:/i))
{
document.write('<div class="codeSnippetContainerTab codeSnippetContainerTabSingle" dir="ltr">');
document.write('<object id=hhctrl type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"><param name="Command" value="ShortCut"><param name="Font" value="Verdana,10pt"><param name="Text" value="Text:Open this Script"><param name="Item1" value=",Examples\\HelpFile\\AdlibRegister.au3,"></object>');
document.write('</div>');
}
</script>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
<script type="text/javascript">
if ((navigator.appName=="Microsoft Internet Explorer") && (parseInt(navigator.appVersion)>=4)) // IE (4+) only
    document.write('<a href="#" id="copy" onclick="copyToClipboard(document.getElementById(\'copytext0\').innerText)">Copy to clipboard</a>');
</script>
            </div>
        </div>
        <div id="copytext0" class="codeSnippetContainerCode" dir="ltr">
<div style="color:Black;"><pre>
<span><span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;Constants.au3&gt;</span>

<span class="S4">AdlibRegister</span><span class="S8">(</span><span class="S7">"MyAdlib"</span><span class="S8">)</span>

<span class="S1">; Sleep does not stop adlib functions from running</span>
<span class="S4">Sleep</span><span class="S8">(</span><span class="S3">1000</span><span class="S8">)</span>

<span class="S1">; Adlib functions won't run while MsgBox is showing</span>
<span class="S4">MsgBox</span><span class="S8">(</span><span class="S9">$MB_SYSTEMMODAL</span><span class="S8">,</span><span class="S0"> </span><span class="S5">Default</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"No console messages while this is showing!"</span><span class="S8">)</span>

<span class="S1">; Now the adlib function will start again</span>
<span class="S4">Sleep</span><span class="S8">(</span><span class="S3">1000</span><span class="S8">)</span>

<span class="S5">Func</span><span class="S0"> MyAdlib</span><span class="S8">()</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S1">;... execution must be non blocking, avoid ...Wait(), MsgBox(), InputBox() functions</span>

<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S5">Static</span><span class="S0"> </span><span class="S9">$iCounter</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$iCounter</span><span class="S0"> </span><span class="S8">+=</span><span class="S0"> </span><span class="S3">1</span>

<span class="S0">&nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Hello from Adlib! "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$iCounter</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span>
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;MyAdlib</span>
<span class="S0"></span></span>
</pre></div>
		</div>
	</div>
</div>


</body>
</html>
